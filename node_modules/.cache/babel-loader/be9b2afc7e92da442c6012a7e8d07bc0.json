{"ast":null,"code":"import _toConsumableArray from\"/Users/itoukazunari/Desktop/ec-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useCallback}from\"react\";import IconButton from\"@material-ui/core/IconButton\";import AddPhotoAlternateIcon from\"@material-ui/icons/AddPhotoAlternate\";import{storage}from'../../firebase/index';import{ImagePreview}from\"./index\";var ImageArea=function ImageArea(props){var images=props.images;// 画像を削除するメソット\nvar deleteImage=useCallback(function(id){var ret=window.confirm('この画像を削除しますか？');if(!ret){return false;}else{var newImages=images.filter(function(image){return image.id!==id;});props.setImages(newImages);return storage.ref('images').child(id).delete();}},[images]);var uploadImage=useCallback(function(event){var file=event.target.files;var blob=new Blob(file,{type:\"image/jpeg\"});// Generate random 16 digits strings\nvar S=\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";var N=16;var fileName=Array.from(crypto.getRandomValues(new Uint32Array(N))).map(function(n){return S[n%S.length];}).join('');var uploadRef=storage.ref('images').child(fileName);var uploadTask=uploadRef.put(blob);uploadTask.then(function(){// Handle successful uploads on complete\nuploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL){var newImage={id:fileName,path:downloadURL};props.setImages(function(prevState){return[].concat(_toConsumableArray(prevState),[newImage]);});});}).catch(function(){});},[props.setImages]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-grid__list-images\",children:images.length>0&&images.map(function(image){return/*#__PURE__*/_jsx(ImagePreview,{id:image.id,path:image.path,delete:deleteImage},image.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"u-text-right\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u5546\\u54C1\\u753B\\u50CF\\u3092\\u767B\\u9332\\u3059\\u308B\"}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(AddPhotoAlternateIcon,{}),/*#__PURE__*/_jsx(\"input\",{className:\"u-display-none\",type:\"file\",id:\"image\",onChange:function onChange(event){return uploadImage(event);}})]})})]})]});};export default ImageArea;","map":{"version":3,"sources":["/Users/itoukazunari/Desktop/ec-app/src/componets/Producuts/ImageArea.jsx"],"names":["React","useCallback","IconButton","AddPhotoAlternateIcon","storage","ImagePreview","ImageArea","props","images","deleteImage","id","ret","window","confirm","newImages","filter","image","setImages","ref","child","delete","uploadImage","event","file","target","files","blob","Blob","type","S","N","fileName","Array","from","crypto","getRandomValues","Uint32Array","map","n","length","join","uploadRef","uploadTask","put","then","snapshot","getDownloadURL","downloadURL","newImage","path","prevState","catch"],"mappings":"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","sourcesContent":["import React, { useCallback } from \"react\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport AddPhotoAlternateIcon from \"@material-ui/icons/AddPhotoAlternate\";\nimport {storage} from '../../firebase/index'\nimport {ImagePreview} from \"./index\";\n\nconst ImageArea = (props) => {\n\n  const images = props.images;\n\n  // 画像を削除するメソット\n\n\n    const deleteImage = useCallback( id => {\n        const ret = window.confirm('この画像を削除しますか？')\n        if (!ret) {\n            return false\n        } else {\n            const newImages = images.filter(image => image.id !== id)\n            props.setImages(newImages);\n            return storage.ref('images').child(id).delete()\n        }\n    }, [images])\n    \n\n  const uploadImage = useCallback((event) => {\n        const file = event.target.files;\n        let blob = new Blob(file, { type: \"image/jpeg\" });\n\n        // Generate random 16 digits strings\n        const S=\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n        const N=16;\n        const fileName = Array.from(crypto.getRandomValues(new Uint32Array(N))).map((n)=>S[n%S.length]).join('')\n\n        const uploadRef = storage.ref('images').child(fileName);\n        const uploadTask = uploadRef.put(blob);\n\n        uploadTask.then(() => {\n            // Handle successful uploads on complete\n            uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {\n                const newImage = {id: fileName, path: downloadURL};\n                props.setImages((prevState => [...prevState, newImage]))\n                \n            });\n        }).catch(() => {\n            \n        });\n    }, [props.setImages])\n\n  return (\n    <div>\n      <div className=\"p-grid__list-images\">\n          {images.length > 0 && (\n              images.map(image => <ImagePreview id={image.id} path={image.path} key={image.id} delete={deleteImage}/> )\n          )}\n      </div>\n      <div className=\"u-text-right\">\n      <span>商品画像を登録する</span>\n      <IconButton>\n        <label>\n          <AddPhotoAlternateIcon />\n          <input\n            className=\"u-display-none\"\n            type=\"file\"\n            id=\"image\"\n            onChange={(event) => uploadImage(event)}\n          />\n        </label>\n      </IconButton>\n    </div>\n    </div>\n  );\n}\nexport default ImageArea"]},"metadata":{},"sourceType":"module"}